import{listaProfessores as s}from"./database-DD0UnsdB.js";import{fecharModal as b,abrirModal as y,configurarListenersModal as x,renderizarPaginacao as B}from"./funcoesGerais-DYcR_P5N.js";for(let t=11;t<=33;t++)s.some(o=>o.id===t)||s.push({id:t,nome:`Professor Teste ${t}`,email:`prof${t}@exemplo.com`,lattes:t%2===0?`http://lattes.cnpq.br/${t}`:"",instituicao:t%3===0?"UFPB":"IFPB",titulacao:t%4===0?"Mestrado":"Doutorado",tipo:t%3===0?"Visitante":t%2===0?"Colaborador":"Permanente",areas:"Área Genérica A, Área Genérica B",ativo:t%5!==0});let g=1;const m=8;let c=[...s];function h(){const t=document.getElementById("professores-table-body"),o=document.getElementById("professores-mobile-container");if(!t){console.warn("Elemento 'professores-table-body' não encontrado.");return}if(t.innerHTML="",o&&(o.innerHTML=""),c.length===0){const a='<div class="px-6 py-8 text-center text-sgd-muted">Nenhum professor encontrado.</div>';t.innerHTML=`<tr><td colspan="7" class="px-6 py-8 text-center text-sgd-muted flex flex-col items-center">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-4 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
            <p class="text-lg">Nenhum professor encontrado.</p>
        </td></tr>`,o&&(o.innerHTML=a),w();return}const e=(g-1)*m,n=e+m;c.slice(e,n).forEach(a=>{let r=a.tipo==="Permanente"?"bg-sgd-gold/20 text-sgd-gold border-sgd-gold/50":a.tipo==="Colaborador"?"bg-blue-900/30 text-blue-400 border-blue-800":"bg-purple-900/30 text-purple-400 border-purple-800";const d=a.ativo?'<div class="flex justify-center" title="Ativo"><span class="flex h-3 w-3 relative"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span></span></div>':'<div class="flex justify-center" title="Inativo"><span class="h-3 w-3 rounded-full bg-red-900 border border-red-700 inline-block"></span></div>',i=a.lattes?`<a href="${a.lattes}" target="_blank" class="flex justify-center text-sgd-muted hover:text-sgd-gold transition" title="Ver Lattes"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg></a>`:'<span class="flex justify-center text-sgd-border opacity-30 cursor-not-allowed"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg></span>',p=document.createElement("tr");if(p.className=`hover:bg-[#1A1A1A] transition-colors ${a.ativo?"":"opacity-50 bg-black/40"}`,p.innerHTML=`
            <td class="table-cell">
                <a href="#" onclick="verProfessor(event, ${a.id})" class="font-medium text-white hover:text-sgd-gold hover:underline transition">
                    ${a.nome}
                </a>
                <div class="text-sgd-muted text-xs truncate max-w-[200px]" title="${a.areas||""}">
                    ${a.areas||"—"}
                </div>
            </td>
            <td class="table-cell">${a.instituicao}</td>
            <td class="table-cell">${a.titulacao}</td>
            <td class="table-cell">${i}</td>
            <td class="table-cell"><span class="px-2 py-1 text-xs font-medium rounded-full border ${r}">${a.tipo}</span></td>
            <td class="table-cell">${d}</td>
            <td class="table-cell text-right">
                <div class="flex items-center justify-end space-x-3">
                    <button onclick="editarProfessor(${a.id})" class="text-sgd-muted hover:text-sgd-gold transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg></button>
                    <button onclick="deletarProfessor(${a.id}, '${a.nome}')" class="text-sgd-muted hover:text-red-500 transition"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button>
                </div>
            </td>`,t.appendChild(p),o){const v=document.createElement("div");v.className="mobile-card",v.innerHTML=`
                <div class="flex justify-between items-start mb-3">
                    <div>
                        <h3 class="text-lg font-semibold text-white" onclick="verProfessor(event, ${a.id})">${a.nome}</h3>
                        <p class="text-sm text-sgd-muted">${a.titulacao} | ${a.instituicao}</p>
                    </div>
                    <span class="px-2 py-1 text-xs font-medium rounded-full border ${r}">${a.tipo}</span>
                </div>
                
                <div class="grid grid-cols-2 gap-2 mb-3">
                    <div>
                        <p class="mobile-label">Áreas</p>
                        <p class="mobile-value truncate" title="${a.areas}">${a.areas||"—"}</p>
                    </div>
                    <div>
                        <p class="mobile-label">Status</p>
                        <p class="mobile-value flex items-center gap-2">
                           ${a.ativo?'<span class="w-2 h-2 rounded-full bg-green-500"></span> Ativo':'<span class="w-2 h-2 rounded-full bg-red-500"></span> Inativo'}
                        </p>
                    </div>
                </div>

                <div class="flex justify-end gap-3 border-t border-sgd-border pt-3">
                     ${a.lattes?`<a href="${a.lattes}" target="_blank" class="text-sm text-sgd-muted hover:text-white px-3 py-1 rounded border border-sgd-border flex items-center gap-1"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg> Lattes</a>`:""}
                    <button onclick="editarProfessor(${a.id})" class="text-sm text-sgd-gold border border-sgd-gold px-3 py-1 rounded hover:bg-sgd-gold hover:text-black transition">Editar</button>
                    <button onclick="deletarProfessor(${a.id}, '${a.nome}')" class="text-sm text-red-500 border border-red-900/50 px-3 py-1 rounded hover:bg-red-900/20">Excluir</button>
                </div>
            `,o.appendChild(v)}}),w()}function w(){B({idContainer:"pagination-container",paginaAtual:g,totalItens:c.length,itensPorPagina:m,nomeFuncaoMudarPagina:"mudarPagina"})}function P(t){const o=Math.ceil(c.length/m);t>=1&&t<=o&&(g=t,h())}function u(){const t=document.getElementById("search-input"),o=document.getElementById("filter-tipo"),e=t?t.value.toLowerCase():"",n=o?o.value.toLowerCase():"";c=s.filter(l=>(l.nome.toLowerCase().includes(e)||l.email.toLowerCase().includes(e)||l.areas&&l.areas.toLowerCase().includes(e))&&(n===""||l.tipo.toLowerCase()===n)),g=1,h()}function M(t,o){t&&t.preventDefault();const e=s.find(d=>d.id===o);if(!e)return;document.getElementById("detail-nome").textContent=e.nome,document.getElementById("detail-titulacao").textContent=e.titulacao,document.getElementById("detail-email").textContent=e.email,document.getElementById("detail-instituicao").textContent=e.instituicao;const n=document.getElementById("detail-lattes-link");e.lattes?(n.href=e.lattes,n.classList.remove("hidden")):n.classList.add("hidden");let l=e.tipo==="Permanente"?"bg-sgd-gold/20 text-sgd-gold border-sgd-gold/50":e.tipo==="Colaborador"?"bg-blue-900/30 text-blue-400 border-blue-800":"bg-purple-900/30 text-purple-400 border-purple-800";document.getElementById("detail-categoria-badge").innerHTML=`<span class="px-2 py-1 text-xs font-medium rounded-full border ${l}">${e.tipo}</span>`;const a=e.ativo?'<span class="px-2 py-1 text-xs font-medium rounded-full bg-green-900/30 text-green-400 border border-green-800">Ativo</span>':'<span class="px-2 py-1 text-xs font-medium rounded-full bg-red-900/30 text-red-400 border border-red-800">Inativo</span>';document.getElementById("detail-status-badge").innerHTML=a;const r=document.getElementById("detail-areas-container");r.innerHTML="",e.areas?e.areas.split(",").forEach(d=>{const i=document.createElement("span");i.className="px-3 py-1 bg-[#333333] text-sgd-text text-sm rounded-full border border-sgd-border",i.textContent=d.trim(),r.appendChild(i)}):r.innerHTML='<span class="text-sgd-muted italic">Nenhuma área registrada.</span>',y("detalhes-modal")}function f(t){const o=document.getElementById("input-instituicao");o&&(t==="Permanente"?(o.value="IFPB",o.setAttribute("readonly",!0),o.classList.add("opacity-50","cursor-not-allowed")):(o.value==="IFPB"&&(o.value=""),o.removeAttribute("readonly"),o.classList.remove("opacity-50","cursor-not-allowed")))}function I(t=null){const o=document.getElementById("professor-form");if(o&&o.reset(),t){document.getElementById("modal-title").textContent="Editar Professor";const e=s.find(n=>n.id===t);e&&(document.getElementById("professor-id").value=e.id,document.getElementById("input-nome").value=e.nome,document.getElementById("input-email").value=e.email,document.getElementById("input-lattes").value=e.lattes,document.getElementById("select-tipo").value=e.tipo,document.getElementById("input-instituicao").value=e.instituicao,document.getElementById("select-titulacao").value=e.titulacao,document.getElementById("input-areas").value=e.areas||"",document.getElementById("check-ativo").checked=e.ativo,f(e.tipo))}else document.getElementById("modal-title").textContent="Novo Professor",document.getElementById("professor-id").value="",f("Permanente");y("professor-modal")}function $(t){t.preventDefault();const o=document.getElementById("professor-id").value,e={id:o?parseInt(o):Date.now(),nome:document.getElementById("input-nome").value,email:document.getElementById("input-email").value,lattes:document.getElementById("input-lattes").value,tipo:document.getElementById("select-tipo").value,instituicao:document.getElementById("input-instituicao").value,titulacao:document.getElementById("select-titulacao").value,areas:document.getElementById("input-areas").value,ativo:document.getElementById("check-ativo").checked};if(o){const n=s.findIndex(l=>l.id===parseInt(o));n!==-1&&(s[n]=e)}else s.unshift(e);b("professor-modal"),u()}function C(t,o){if(confirm(`Remover "${o}"? Esta ação não pode ser desfeita.`)){const e=s.findIndex(n=>n.id===t);e!==-1&&s.splice(e,1),u()}}function E(){if(document.getElementById("professores-table-body")||document.getElementById("professores-mobile-container")){h(),x({idModal:"professor-modal",fecharAoClicarFora:!0}),x({idModal:"detalhes-modal",fecharAoClicarFora:!0});const t=document.getElementById("professor-form");t&&t.addEventListener("submit",$);const o=document.getElementById("search-input"),e=document.getElementById("filter-tipo");o&&o.addEventListener("keyup",u),e&&e.addEventListener("change",u)}else console.warn("Elementos da página de professores não encontrados. Aguardando DOMContentLoaded."),document.addEventListener("DOMContentLoaded",E)}window.aplicarFiltros=u;window.abrirModalProfessor=I;window.fecharModalProfessor=()=>b("professor-modal");window.alternarInstituicao=f;window.deletarProfessor=C;window.editarProfessor=I;window.mudarPagina=P;window.verProfessor=M;window.fecharModalDetalhes=()=>b("detalhes-modal");E();
